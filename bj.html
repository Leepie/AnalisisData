<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JANAlytics - Sistem Analisis Prestasi Akademik</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @media (prefers-color-scheme: dark) {
            .dark-auto {
                --tw-bg-opacity: 1;
                background-color: rgb(17 24 39 / var(--tw-bg-opacity));
                --tw-text-opacity: 1;
                color: rgb(243 244 246 / var(--tw-text-opacity));
            }
            .dark-auto .gradient-bg {
                background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 50%, #1e1b4b 100%);
            }
            .dark-auto .card-dark {
                background: rgba(31, 41, 55, 0.8);
                border-color: rgba(75, 85, 99, 0.3);
            }
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #3b82f6 0%, #6366f1 50%, #4f46e5 100%);
        }
        
        .footer-gradient {
            background: linear-gradient(135deg, #1f2937 0%, #111827 50%, #000000 100%);
        }
        
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .stat-card {
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .tab-btn.active {
            background-color: rgb(219 234 254);
            color: rgb(29 78 216);
        }
        
        @media (prefers-color-scheme: dark) {
            .dark-auto .tab-btn.active {
                background-color: rgb(30 58 138);
                color: rgb(147 197 253);
            }
        }
        
        .loading-spinner {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50 dark-auto transition-colors duration-300">
    <!-- Header -->
    <header class="gradient-bg shadow-xl">
        <div class="container mx-auto px-6 py-8">
            <!-- Logo and Title Section -->
            <div class="flex items-center justify-center mb-8">
                <div class="flex items-center space-x-4">
                    <div class="text-6xl">🏫</div>
                    <div class="text-center">
                        <h1 class="text-4xl md:text-5xl font-bold text-white mb-2 tracking-tight">
                            JANAlytics
                        </h1>
                        <p class="text-blue-100 text-lg md:text-xl font-medium">
                            Sistem Analisis Prestasi Akademik SMK Bukit Jana
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-2xl mx-auto">
                <div class="stat-card glass-effect rounded-xl p-6 text-center">
                    <div id="totalCertificateHeader" class="text-3xl md:text-4xl font-bold text-white mb-2">85.2%</div>
                    <div class="text-blue-100 font-medium">Peratus Layak Sijil</div>
                    <div class="text-blue-200 text-sm mt-1">Tahun Semasa</div>
                </div>
                
                <div class="stat-card glass-effect rounded-xl p-6 text-center">
                    <div id="gpsHeader" class="text-3xl md:text-4xl font-bold text-white mb-2">3.45</div>
                    <div class="text-blue-100 font-medium">GPS Purata</div>
                    <div class="text-blue-200 text-sm mt-1">Keseluruhan Sekolah</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="bg-white dark-auto shadow-md border-b border-gray-200 dark:border-gray-700 sticky top-0 z-50">
        <div class="container mx-auto px-6">
            <!-- Desktop Tab Bar -->
            <div class="hidden md:flex space-x-1 py-4">
                <button id="keseluruhan" onclick="showTab('keseluruhan')" class="tab-btn active px-6 py-3 rounded-lg font-medium transition-all duration-200 bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300">
                    📊 Keseluruhan
                </button>
                <button id="matapelajaran" onclick="showTab('matapelajaran')" class="tab-btn px-6 py-3 rounded-lg font-medium transition-all duration-200 text-gray-600 hover:text-blue-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-gray-700">
                    📚 Mata Pelajaran
                </button>
                <button id="layaksijil" onclick="showTab('layaksijil')" class="tab-btn px-6 py-3 rounded-lg font-medium transition-all duration-200 text-gray-600 hover:text-blue-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-gray-700">
                    🎓 Layak Sijil
                </button>
                <button id="combatzone" onclick="showTab('combatzone')" class="tab-btn px-6 py-3 rounded-lg font-medium transition-all duration-200 text-gray-600 hover:text-blue-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-gray-700">
                    ⚔️ Combat Zone
                </button>
                <button id="individu" onclick="showTab('individu')" class="tab-btn px-6 py-3 rounded-lg font-medium transition-all duration-200 text-gray-600 hover:text-blue-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-gray-700">
                    👤 Individu
                </button>
            </div>
            
            <!-- Mobile Dropdown -->
            <div class="md:hidden py-4">
                <select id="mobileTabSelector" onchange="showTab(this.value)" class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 font-medium focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <option value="keseluruhan">📊 Keseluruhan</option>
                    <option value="matapelajaran">📚 Mata Pelajaran</option>
                    <option value="layaksijil">🎓 Layak Sijil</option>
                    <option value="combatzone">⚔️ Combat Zone</option>
                    <option value="individu">👤 Individu</option>
                </select>
            </div>
        </div>
    </nav>

    <!-- Loading Spinner -->
    <div id="loading" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
        <div class="bg-white dark:bg-gray-800 rounded-xl p-8 text-center shadow-2xl">
            <div class="loading-spinner rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"></div>
            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-2">Memuat Data...</h3>
            <p class="text-gray-600 dark:text-gray-400">Mengambil data prestasi pelajar dari Google Sheets</p>
        </div>
    </div>

    <!-- Main Content Area -->
    <main class="container mx-auto px-6 py-12">
        <!-- Tab Content: Keseluruhan -->
        <div id="keseluruhan-content" class="tab-content active">
            <!-- Filters Section -->
            <div class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6 mb-8">
                <h2 class="text-xl font-bold text-gray-800 dark:text-gray-200 mb-4">🔍 Penapis Analisis</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                    <div>
                        <label for="kelasFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Kelas</label>
                        <select id="kelasFilter" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300">
                            <option value="">Semua Kelas</option>
                            <option value="5A1">5A1</option>
                            <option value="5A2">5A2</option>
                            <option value="5S1">5S1</option>
                            <option value="5S2">5S2</option>
                        </select>
                    </div>
                    <div>
                        <label for="bidangFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Bidang</label>
                        <select id="bidangFilter" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300">
                            <option value="">Semua Bidang</option>
                            <option value="BAHASA">Bahasa</option>
                            <option value="SAINS_MATEMATIK">Sains & Matematik</option>
                            <option value="TEKNIK_VOKASIONAL">Teknik & Vokasional</option>
                            <option value="KEMANUSIAAN">Kemanusiaan</option>
                        </select>
                    </div>
                    <div>
                        <button onclick="generateOverallAnalysis()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                            📊 Jana Analisis
                        </button>
                    </div>
                </div>
            </div>

            <!-- Top Students Section -->
            <div class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6 mb-8">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200">🏆 Pelajar Terbaik</h3>
                    <select id="topStudentsCount" onchange="generateTopStudents()" class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300">
                        <option value="10">Top 10</option>
                        <option value="20">Top 20</option>
                        <option value="50">Top 50</option>
                    </select>
                </div>
                <div class="overflow-x-auto">
                    <table id="topStudentsTable" class="w-full text-sm">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-300">Ranking</th>
                                <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-300">Nama</th>
                                <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-300">Kelas</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">A+</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">A</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">A-</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">B+</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">GPS</th>
                            </tr>
                        </thead>
                        <tbody id="topStudentsBody" class="divide-y divide-gray-200 dark:divide-gray-600">
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="px-4 py-2 font-medium">1</td>
                                <td class="px-4 py-2">Ahmad Faiz bin Abdullah</td>
                                <td class="px-4 py-2">5A1</td>
                                <td class="px-4 py-2 text-center font-bold text-green-600">8</td>
                                <td class="px-4 py-2 text-center font-bold text-green-700">2</td>
                                <td class="px-4 py-2 text-center font-bold text-green-800">1</td>
                                <td class="px-4 py-2 text-center font-bold text-blue-600">0</td>
                                <td class="px-4 py-2 text-center font-bold text-gray-800 dark:text-gray-200">0.82</td>
                            </tr>
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="px-4 py-2 font-medium">2</td>
                                <td class="px-4 py-2">Siti Nurhaliza binti Hassan</td>
                                <td class="px-4 py-2">5A1</td>
                                <td class="px-4 py-2 text-center font-bold text-green-600">7</td>
                                <td class="px-4 py-2 text-center font-bold text-green-700">3</td>
                                <td class="px-4 py-2 text-center font-bold text-green-800">1</td>
                                <td class="px-4 py-2 text-center font-bold text-blue-600">0</td>
                                <td class="px-4 py-2 text-center font-bold text-gray-800 dark:text-gray-200">0.91</td>
                            </tr>
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="px-4 py-2 font-medium">3</td>
                                <td class="px-4 py-2">Muhammad Aidil bin Razak</td>
                                <td class="px-4 py-2">5S1</td>
                                <td class="px-4 py-2 text-center font-bold text-green-600">6</td>
                                <td class="px-4 py-2 text-center font-bold text-green-700">4</td>
                                <td class="px-4 py-2 text-center font-bold text-green-800">1</td>
                                <td class="px-4 py-2 text-center font-bold text-blue-600">0</td>
                                <td class="px-4 py-2 text-center font-bold text-gray-800 dark:text-gray-200">1.00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Grade Distribution Chart -->
            <div class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6 mb-8">
                <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200 mb-4">📊 Carta Taburan Gred</h3>
                <div class="relative h-96">
                    <canvas id="gradeChart" class="w-full h-full"></canvas>
                </div>
            </div>

            <!-- School GPS Card -->
            <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-xl shadow-lg p-6 mb-8">
                <div class="text-center">
                    <h3 class="text-lg font-bold text-blue-700 dark:text-blue-300 mb-2">🎯 GPS Sekolah</h3>
                    <div id="schoolGPSCard" class="text-4xl font-bold text-blue-800 dark:text-blue-200 mb-2">3.45</div>
                    <div class="text-blue-600 dark:text-blue-400">Purata Keseluruhan (Tidak Termasuk MPAK)</div>
                </div>
            </div>

            <!-- Subject Analysis Table -->
            <div class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200 mb-4">📚 Analisis Setiap Mata Pelajaran</h3>
                <div class="overflow-x-auto">
                    <table id="subjectAnalysisTable" class="w-full text-sm">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-3 py-2 text-left text-gray-700 dark:text-gray-300">Mata Pelajaran</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">Hadir</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">TH</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">A+</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">A</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">A-</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">B+</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">B</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">C+</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">C</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">D</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">E</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">G</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">Lulus</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">Gagal</th>
                                <th class="px-3 py-2 text-center text-gray-700 dark:text-gray-300">GPMP</th>
                            </tr>
                        </thead>
                        <tbody id="subjectAnalysisBody" class="divide-y divide-gray-200 dark:divide-gray-600">
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="px-3 py-2 font-medium">BAHASA MELAYU</td>
                                <td class="px-3 py-2 text-center">120</td>
                                <td class="px-3 py-2 text-center">2</td>
                                <td class="px-3 py-2 text-center text-green-600 bg-green-50 dark:bg-green-900 dark:text-green-400">25</td>
                                <td class="px-3 py-2 text-center text-green-700 bg-green-50 dark:bg-green-900 dark:text-green-300">35</td>
                                <td class="px-3 py-2 text-center text-green-800 bg-green-50 dark:bg-green-900 dark:text-green-200">28</td>
                                <td class="px-3 py-2 text-center text-blue-600 bg-blue-50 dark:bg-blue-900 dark:text-blue-400">20</td>
                                <td class="px-3 py-2 text-center text-blue-700 bg-blue-50 dark:bg-blue-900 dark:text-blue-300">8</td>
                                <td class="px-3 py-2 text-center text-yellow-600 bg-yellow-50 dark:bg-yellow-900 dark:text-yellow-400">3</td>
                                <td class="px-3 py-2 text-center text-yellow-700 bg-yellow-50 dark:bg-yellow-900 dark:text-yellow-300">1</td>
                                <td class="px-3 py-2 text-center text-orange-600 bg-orange-50 dark:bg-orange-900 dark:text-orange-400">0</td>
                                <td class="px-3 py-2 text-center text-red-600 bg-red-50 dark:bg-red-900 dark:text-red-400">0</td>
                                <td class="px-3 py-2 text-center text-red-800 bg-red-50 dark:bg-red-900 dark:text-red-200">0</td>
                                <td class="px-3 py-2 text-center text-green-600 font-medium">120</td>
                                <td class="px-3 py-2 text-center text-red-600 font-medium">0</td>
                                <td class="px-3 py-2 text-center font-bold">2.15</td>
                            </tr>
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="px-3 py-2 font-medium">MATEMATIK</td>
                                <td class="px-3 py-2 text-center">118</td>
                                <td class="px-3 py-2 text-center">4</td>
                                <td class="px-3 py-2 text-center text-green-600 bg-green-50 dark:bg-green-900 dark:text-green-400">18</td>
                                <td class="px-3 py-2 text-center text-green-700 bg-green-50 dark:bg-green-900 dark:text-green-300">22</td>
                                <td class="px-3 py-2 text-center text-green-800 bg-green-50 dark:bg-green-900 dark:text-green-200">25</td>
                                <td class="px-3 py-2 text-center text-blue-600 bg-blue-50 dark:bg-blue-900 dark:text-blue-400">28</td>
                                <td class="px-3 py-2 text-center text-blue-700 bg-blue-50 dark:bg-blue-900 dark:text-blue-300">15</td>
                                <td class="px-3 py-2 text-center text-yellow-600 bg-yellow-50 dark:bg-yellow-900 dark:text-yellow-400">8</td>
                                <td class="px-3 py-2 text-center text-yellow-700 bg-yellow-50 dark:bg-yellow-900 dark:text-yellow-300">2</td>
                                <td class="px-3 py-2 text-center text-orange-600 bg-orange-50 dark:bg-orange-900 dark:text-orange-400">0</td>
                                <td class="px-3 py-2 text-center text-red-600 bg-red-50 dark:bg-red-900 dark:text-red-400">0</td>
                                <td class="px-3 py-2 text-center text-red-800 bg-red-50 dark:bg-red-900 dark:text-red-200">0</td>
                                <td class="px-3 py-2 text-center text-green-600 font-medium">118</td>
                                <td class="px-3 py-2 text-center text-red-600 font-medium">0</td>
                                <td class="px-3 py-2 text-center font-bold">2.85</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Tab Content: Mata Pelajaran -->
        <div id="matapelajaran-content" class="tab-content">
            <!-- Filters Section -->
            <div class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6 mb-8">
                <h2 class="text-xl font-bold text-gray-800 dark:text-gray-200 mb-4">🔍 Penapis Mata Pelajaran</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                    <div>
                        <label for="kelasFilterMP" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Kelas</label>
                        <select id="kelasFilterMP" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300">
                            <option value="">Semua Kelas</option>
                            <option value="5A1">5A1</option>
                            <option value="5A2">5A2</option>
                            <option value="5S1">5S1</option>
                            <option value="5S2">5S2</option>
                        </select>
                    </div>
                    <div>
                        <label for="mataPelajaranFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Mata Pelajaran</label>
                        <select id="mataPelajaranFilter" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300">
                            <option value="">Pilih Mata Pelajaran</option>
                            <option value="BAHASA MELAYU">BAHASA MELAYU</option>
                            <option value="MATEMATIK">MATEMATIK</option>
                            <option value="SAINS">SAINS</option>
                            <option value="SEJARAH">SEJARAH</option>
                        </select>
                    </div>
                    <div>
                        <button onclick="generateSubjectAnalysis()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                            📚 Jana Analisis
                        </button>
                    </div>
                </div>
            </div>

            <!-- Subject Statistics Card -->
            <div id="subjectStats" class="bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900 dark:to-purple-800 rounded-xl shadow-lg p-6 mb-8" style="display: none;">
                <h3 class="text-lg font-bold text-purple-700 dark:text-purple-300 mb-4">📊 Statistik Mata Pelajaran</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="text-center">
                        <div id="totalStudentsSubject" class="text-2xl font-bold text-purple-800 dark:text-purple-200">120</div>
                        <div class="text-purple-600 dark:text-purple-400 text-sm">Jumlah Murid</div>
                    </div>
                    <div class="text-center">
                        <div id="highestMark" class="text-2xl font-bold text-purple-800 dark:text-purple-200">95</div>
                        <div class="text-purple-600 dark:text-purple-400 text-sm">Markah Tertinggi</div>
                    </div>
                    <div class="text-center">
                        <div id="lowestMark" class="text-2xl font-bold text-purple-800 dark:text-purple-200">45</div>
                        <div class="text-purple-600 dark:text-purple-400 text-sm">Markah Terendah</div>
                    </div>
                </div>
            </div>

            <!-- Student List -->
            <div id="studentListContainer" class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6" style="display: none;">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200">👥 Senarai Murid</h3>
                    <div class="flex items-center space-x-4">
                        <!-- Sort Controls -->
                        <div class="flex items-center space-x-2">
                            <label class="text-sm text-gray-600 dark:text-gray-400">Susun:</label>
                            <select id="sortBy" onchange="updateStudentListDisplay()" class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 text-sm">
                                <option value="nama">Nama</option>
                                <option value="kelas">Kelas</option>
                                <option value="markah">Markah</option>
                                <option value="gred">Gred</option>
                            </select>
                            <select id="sortOrder" onchange="updateStudentListDisplay()" class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 text-sm">
                                <option value="asc">A-Z</option>
                                <option value="desc">Z-A</option>
                            </select>
                        </div>
                        <!-- Rows per page -->
                        <div class="flex items-center space-x-2">
                            <label class="text-sm text-gray-600 dark:text-gray-400">Papar:</label>
                            <select id="rowsPerPageSelect" onchange="updateStudentListDisplay()" class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 text-sm">
                                <option value="10">10</option>
                                <option value="25">25</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                                <option value="all">Semua</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table id="studentListTable" class="w-full text-sm">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-300">Bil</th>
                                <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-300">Nama</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Kelas</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Markah</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Gred</th>
                            </tr>
                        </thead>
                        <tbody id="studentListBody" class="divide-y divide-gray-200 dark:divide-gray-600">
                            <tr>
                                <td colspan="5" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                    <div class="flex flex-col items-center">
                                        <div class="text-4xl mb-2">👥</div>
                                        <div>Pilih mata pelajaran dan klik "Jana Analisis"</div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Pagination -->
                <div id="paginationContainer" class="flex justify-between items-center mt-4" style="display: none;">
                    <div class="text-sm text-gray-600 dark:text-gray-400">
                        Memaparkan <span id="showingFrom">0</span> hingga <span id="showingTo">0</span> daripada <span id="totalRecords">0</span> rekod
                    </div>
                    <div class="flex items-center space-x-2">
                        <button id="prevPage" onclick="changePage(-1)" class="px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-300 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed">
                            ← Sebelum
                        </button>
                        <span id="pageInfo" class="px-3 py-1 text-sm text-gray-600 dark:text-gray-400">
                            Halaman 1 daripada 1
                        </span>
                        <button id="nextPage" onclick="changePage(1)" class="px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-300 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed">
                            Seterus →
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Content: Layak Sijil -->
        <div id="layaksijil-content" class="tab-content">
            <!-- Filters Section -->
            <div class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6 mb-8">
                <h2 class="text-xl font-bold text-gray-800 dark:text-gray-200 mb-4">🔍 Penapis Layak Sijil</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-end">
                    <div>
                        <label for="kelasFilterSijil" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Kelas</label>
                        <select id="kelasFilterSijil" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300">
                            <option value="">Semua Kelas</option>
                            <option value="5A1">5A1</option>
                            <option value="5A2">5A2</option>
                            <option value="5S1">5S1</option>
                            <option value="5S2">5S2</option>
                        </select>
                    </div>
                    <div>
                        <button onclick="generateCertificateAnalysis()" class="w-full bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                            🎓 Jana Analisis
                        </button>
                    </div>
                </div>
            </div>

            <!-- Certificate Summary Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 rounded-xl shadow-lg p-6">
                    <div class="text-center">
                        <div class="text-4xl mb-2">🎓</div>
                        <div id="layakSijilCount" class="text-3xl font-bold text-green-700 dark:text-green-300 mb-1">102</div>
                        <div id="layakSijilPercent" class="text-xl font-semibold text-green-600 dark:text-green-400 mb-2">85.0%</div>
                        <div class="text-green-600 dark:text-green-400 font-medium">Layak Sijil</div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900 dark:to-red-800 rounded-xl shadow-lg p-6">
                    <div class="text-center">
                        <div class="text-4xl mb-2">❌</div>
                        <div id="gagalSijilCount" class="text-3xl font-bold text-red-700 dark:text-red-300 mb-1">18</div>
                        <div id="gagalSijilPercent" class="text-xl font-semibold text-red-600 dark:text-red-400 mb-2">15.0%</div>
                        <div class="text-red-600 dark:text-red-400 font-medium">Tidak Layak Sijil</div>
                    </div>
                </div>
            </div>

            <!-- Cross Analysis Matrix -->
            <div class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6 mb-8">
                <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200 mb-4">📊 Matriks Silang BM × Sejarah</h3>
                <div class="overflow-x-auto">
                    <table id="crossAnalysisTable" class="w-full text-sm">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-300">BM \ Sejarah</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">LULUS</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">GAGAL</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">TH</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300 bg-blue-100 dark:bg-blue-900">JUMLAH</th>
                            </tr>
                        </thead>
                        <tbody id="crossAnalysisBody" class="divide-y divide-gray-200 dark:divide-gray-600">
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="px-4 py-2 font-medium">LULUS</td>
                                <td class="px-4 py-2 text-center">102<br><small class="text-gray-500">(85.0%)</small></td>
                                <td class="px-4 py-2 text-center">15<br><small class="text-gray-500">(12.5%)</small></td>
                                <td class="px-4 py-2 text-center">3<br><small class="text-gray-500">(2.5%)</small></td>
                                <td class="px-4 py-2 text-center font-bold bg-blue-50 dark:bg-blue-900">120</td>
                            </tr>
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="px-4 py-2 font-medium">GAGAL</td>
                                <td class="px-4 py-2 text-center">0<br><small class="text-gray-500">(0.0%)</small></td>
                                <td class="px-4 py-2 text-center">0<br><small class="text-gray-500">(0.0%)</small></td>
                                <td class="px-4 py-2 text-center">0<br><small class="text-gray-500">(0.0%)</small></td>
                                <td class="px-4 py-2 text-center font-bold bg-blue-50 dark:bg-blue-900">0</td>
                            </tr>
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="px-4 py-2 font-medium">TH</td>
                                <td class="px-4 py-2 text-center">0<br><small class="text-gray-500">(0.0%)</small></td>
                                <td class="px-4 py-2 text-center">0<br><small class="text-gray-500">(0.0%)</small></td>
                                <td class="px-4 py-2 text-center">2<br><small class="text-gray-500">(100.0%)</small></td>
                                <td class="px-4 py-2 text-center font-bold bg-blue-50 dark:bg-blue-900">2</td>
                            </tr>
                            <tr class="bg-blue-100 dark:bg-blue-800 font-bold">
                                <td class="px-4 py-2">JUMLAH</td>
                                <td class="px-4 py-2 text-center bg-blue-50 dark:bg-blue-900">102<br><small class="text-gray-500">(83.6%)</small></td>
                                <td class="px-4 py-2 text-center bg-blue-50 dark:bg-blue-900">15<br><small class="text-gray-500">(12.3%)</small></td>
                                <td class="px-4 py-2 text-center bg-blue-50 dark:bg-blue-900">5<br><small class="text-gray-500">(4.1%)</small></td>
                                <td class="px-4 py-2 text-center bg-blue-200 dark:bg-blue-700">122</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Student List -->
            <div class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200">👥 Senarai Murid</h3>
                    <div class="flex items-center space-x-4">
                        <!-- Sort Controls -->
                        <div class="flex items-center space-x-2">
                            <label class="text-sm text-gray-600 dark:text-gray-400">Susun:</label>
                            <select id="sortBySijil" onchange="updateCertificateStudentListDisplay()" class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 text-sm">
                                <option value="nama">Nama</option>
                                <option value="kelas">Kelas</option>
                                <option value="bmMarkah">BM Markah</option>
                                <option value="bmGred">BM Gred</option>
                                <option value="sejarahMarkah">Sejarah Markah</option>
                                <option value="sejarahGred">Sejarah Gred</option>
                            </select>
                            <select id="sortOrderSijil" onchange="updateCertificateStudentListDisplay()" class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 text-sm">
                                <option value="asc">A-Z</option>
                                <option value="desc">Z-A</option>
                            </select>
                        </div>
                        <!-- Rows per page -->
                        <div class="flex items-center space-x-2">
                            <label class="text-sm text-gray-600 dark:text-gray-400">Papar:</label>
                            <select id="rowsPerPageSijil" onchange="updateCertificateStudentListDisplay()" class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 text-sm">
                                <option value="10">10</option>
                                <option value="25">25</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                                <option value="all">Semua</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table id="certificateStudentTable" class="w-full text-sm">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-300">Bil</th>
                                <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-300">Nama</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Kelas</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">BM Markah</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">BM Gred</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Sejarah Markah</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Sejarah Gred</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Status Sijil</th>
                            </tr>
                        </thead>
                        <tbody id="certificateStudentBody" class="divide-y divide-gray-200 dark:divide-gray-600">
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="px-4 py-2">1</td>
                                <td class="px-4 py-2">Ahmad Faiz bin Abdullah</td>
                                <td class="px-4 py-2 text-center">5A1</td>
                                <td class="px-4 py-2 text-center">85</td>
                                <td class="px-4 py-2 text-center">
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800">A</span>
                                </td>
                                <td class="px-4 py-2 text-center">78</td>
                                <td class="px-4 py-2 text-center">
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800">A-</span>
                                </td>
                                <td class="px-4 py-2 text-center">
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800">LAYAK</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Tab Content: Combat Zone -->
        <div id="combatzone-content" class="tab-content">
            <!-- Filters Section -->
            <div class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6 mb-8">
                <h2 class="text-xl font-bold text-gray-800 dark:text-gray-200 mb-4">⚔️ Penapis Combat Zone</h2>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
                    <div>
                        <label for="kelasFilterCombat" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Kelas</label>
                        <select id="kelasFilterCombat" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300">
                            <option value="">Semua Kelas</option>
                            <option value="5A1">5A1</option>
                            <option value="5A2">5A2</option>
                            <option value="5S1">5S1</option>
                            <option value="5S2">5S2</option>
                        </select>
                    </div>
                    <div>
                        <label for="mataPelajaranFilterCombat" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Mata Pelajaran</label>
                        <select id="mataPelajaranFilterCombat" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300">
                            <option value="">Semua Mata Pelajaran</option>
                            <option value="BAHASA MELAYU">BAHASA MELAYU</option>
                            <option value="MATEMATIK">MATEMATIK</option>
                            <option value="SAINS">SAINS</option>
                            <option value="SEJARAH">SEJARAH</option>
                        </select>
                    </div>
                    <div>
                        <label for="kategoriFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Kategori</label>
                        <select id="kategoriFilter" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300">
                            <option value="">Pilih Kategori</option>
                            <option value="kualiti1">🏆 Kualiti 1 (A+, A, A-)</option>
                            <option value="kualiti2">🥈 Kualiti 2 (B+, B)</option>
                            <option value="pertahanan1">🛡️ Pertahanan 1 (C+, C)</option>
                            <option value="pertahanan2">⚠️ Pertahanan 2 (D, E)</option>
                            <option value="kritikal">🚨 Kritikal (G, TH)</option>
                        </select>
                    </div>
                    <div>
                        <button onclick="generateCombatZoneAnalysis()" class="w-full bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                            ⚔️ Jana Analisis
                        </button>
                    </div>
                </div>
            </div>

            <!-- Category Summary Card -->
            <div id="categorySummaryCard" class="bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900 dark:to-red-800 rounded-xl shadow-lg p-6 mb-8" style="display: none;">
                <h3 class="text-lg font-bold text-red-700 dark:text-red-300 mb-4">📊 Ringkasan Kategori</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="text-center">
                        <div class="text-sm text-red-600 dark:text-red-400 mb-1">Kategori Dipilih</div>
                        <div id="selectedCategoryName" class="text-xl font-bold text-red-800 dark:text-red-200">🏆 Kualiti 1</div>
                    </div>
                    <div class="text-center">
                        <div class="text-sm text-red-600 dark:text-red-400 mb-1">Gred Termasuk</div>
                        <div id="selectedCategoryGrades" class="text-xl font-bold text-red-800 dark:text-red-200">A+, A, A-</div>
                    </div>
                    <div class="text-center">
                        <div class="text-sm text-red-600 dark:text-red-400 mb-1">Jumlah Pelajar</div>
                        <div id="categoryStudentCount" class="text-xl font-bold text-red-800 dark:text-red-200">88</div>
                    </div>
                </div>
            </div>

            <!-- Student List -->
            <div id="combatStudentTableContainer" class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6" style="display: none;">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200">👥 Senarai Pelajar dalam Kategori</h3>
                    <div class="flex items-center space-x-4">
                        <!-- Sort Controls -->
                        <div class="flex items-center space-x-2">
                            <label class="text-sm text-gray-600 dark:text-gray-400">Susun:</label>
                            <select id="sortByCombat" onchange="updateCombatStudentListDisplay()" class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 text-sm">
                                <option value="nama">Nama</option>
                                <option value="kelas">Kelas</option>
                                <option value="markah">Markah</option>
                                <option value="gred">Gred</option>
                            </select>
                            <select id="sortOrderCombat" onchange="updateCombatStudentListDisplay()" class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 text-sm">
                                <option value="asc">A-Z</option>
                                <option value="desc">Z-A</option>
                            </select>
                        </div>
                        <!-- Rows per page -->
                        <div class="flex items-center space-x-2">
                            <label class="text-sm text-gray-600 dark:text-gray-400">Papar:</label>
                            <select id="rowsPerPageCombat" onchange="updateCombatStudentListDisplay()" class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 text-sm">
                                <option value="10">10</option>
                                <option value="25">25</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                                <option value="all">Semua</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table id="combatStudentTable" class="w-full text-sm">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-300">Bil</th>
                                <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-300">Nama</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Kelas</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Mata Pelajaran</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Markah</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Gred</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Status</th>
                            </tr>
                        </thead>
                        <tbody id="combatStudentBody" class="divide-y divide-gray-200 dark:divide-gray-600">
                            <tr>
                                <td colspan="7" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                                    <div class="flex flex-col items-center">
                                        <div class="text-4xl mb-2">⚔️</div>
                                        <div>Pilih kategori dan klik "Jana Analisis"</div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Tab Content: Individu -->
        <div id="individu-content" class="tab-content">
            <!-- Filters Section -->
            <div class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6 mb-8">
                <h2 class="text-xl font-bold text-gray-800 dark:text-gray-200 mb-4">🔍 Carian Pelajar</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                    <div>
                        <label for="kelasFilterIndividu" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Kelas</label>
                        <select id="kelasFilterIndividu" onchange="updateNameFilter()" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300">
                            <option value="">Semua Kelas</option>
                            <option value="5A1">5A1</option>
                            <option value="5A2">5A2</option>
                            <option value="5S1">5S1</option>
                            <option value="5S2">5S2</option>
                        </select>
                    </div>
                    <div>
                        <label for="namaFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Nama Pelajar</label>
                        <select id="namaFilter" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300">
                            <option value="">Pilih Pelajar</option>
                            <option value="Ahmad Faiz bin Abdullah">Ahmad Faiz bin Abdullah (5A1)</option>
                            <option value="Siti Nurhaliza binti Hassan">Siti Nurhaliza binti Hassan (5A1)</option>
                            <option value="Muhammad Aidil bin Razak">Muhammad Aidil bin Razak (5S1)</option>
                        </select>
                    </div>
                    <div>
                        <button onclick="generateIndividualAnalysis()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                            👤 Jana Analisis
                        </button>
                    </div>
                </div>
            </div>

            <!-- Student Information Card -->
            <div id="studentInfo" class="bg-gradient-to-br from-indigo-50 to-indigo-100 dark:from-indigo-900 dark:to-indigo-800 rounded-xl shadow-lg p-6 mb-8" style="display: none;">
                <h3 class="text-lg font-bold text-indigo-700 dark:text-indigo-300 mb-4">📋 Maklumat Pelajar</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="text-center">
                        <div class="text-sm text-indigo-600 dark:text-indigo-400 mb-1">Nama</div>
                        <div id="studentName" class="text-xl font-bold text-indigo-800 dark:text-indigo-200">Ahmad Faiz bin Abdullah</div>
                    </div>
                    <div class="text-center">
                        <div class="text-sm text-indigo-600 dark:text-indigo-400 mb-1">Kelas</div>
                        <div id="studentClass" class="text-xl font-bold text-indigo-800 dark:text-indigo-200">5A1</div>
                    </div>
                    <div class="text-center">
                        <div class="text-sm text-indigo-600 dark:text-indigo-400 mb-1">No. MyKad</div>
                        <div id="studentIC" class="text-xl font-bold text-indigo-800 dark:text-indigo-200">050123-01-1234</div>
                    </div>
                </div>
            </div>

            <!-- Grade Summary -->
            <div id="gradeSummary" class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6 mb-8" style="display: none;">
                <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200 mb-4">📊 Ringkasan Gred</h3>
                <div class="grid grid-cols-2 md:grid-cols-6 gap-4 mb-4">
                    <div class="text-center p-3 bg-green-50 dark:bg-green-900 rounded-lg">
                        <div id="gradeAPlus" class="text-2xl font-bold text-green-600 dark:text-green-400">8</div>
                        <div class="text-sm text-green-700 dark:text-green-300">A+</div>
                    </div>
                    <div class="text-center p-3 bg-green-50 dark:bg-green-900 rounded-lg">
                        <div id="gradeA" class="text-2xl font-bold text-green-600 dark:text-green-400">2</div>
                        <div class="text-sm text-green-700 dark:text-green-300">A</div>
                    </div>
                    <div class="text-center p-3 bg-green-50 dark:bg-green-900 rounded-lg">
                        <div id="gradeAMinus" class="text-2xl font-bold text-green-600 dark:text-green-400">1</div>
                        <div class="text-sm text-green-700 dark:text-green-300">A-</div>
                    </div>
                    <div class="text-center p-3 bg-blue-50 dark:bg-blue-900 rounded-lg">
                        <div id="gradeBPlus" class="text-2xl font-bold text-blue-600 dark:text-blue-400">0</div>
                        <div class="text-sm text-blue-700 dark:text-blue-300">B+</div>
                    </div>
                    <div class="text-center p-3 bg-blue-50 dark:bg-blue-900 rounded-lg">
                        <div id="gradeB" class="text-2xl font-bold text-blue-600 dark:text-blue-400">0</div>
                        <div class="text-sm text-blue-700 dark:text-blue-300">B</div>
                    </div>
                    <div class="text-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <div id="gradeTH" class="text-2xl font-bold text-gray-600 dark:text-gray-400">0</div>
                        <div class="text-sm text-gray-700 dark:text-gray-300">TH</div>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="text-center p-4 bg-purple-50 dark:bg-purple-900 rounded-lg">
                        <div id="totalSubjects" class="text-2xl font-bold text-purple-600 dark:text-purple-400">11</div>
                        <div class="text-sm text-purple-700 dark:text-purple-300">Jumlah Mata Pelajaran</div>
                    </div>
                    <div class="text-center p-4 bg-green-50 dark:bg-green-900 rounded-lg">
                        <div id="passedSubjects" class="text-2xl font-bold text-green-600 dark:text-green-400">11</div>
                        <div class="text-sm text-green-700 dark:text-green-300">Lulus</div>
                    </div>
                    <div class="text-center p-4 bg-orange-50 dark:bg-orange-900 rounded-lg">
                        <div id="studentGPS" class="text-2xl font-bold text-orange-600 dark:text-orange-400">0.82</div>
                        <div class="text-sm text-orange-700 dark:text-orange-300">GPS Individu</div>
                    </div>
                </div>
            </div>

            <!-- Individual Results Table -->
            <div id="individualResultsContainer" class="bg-white dark-auto card-dark rounded-xl shadow-lg p-6" style="display: none;">
                <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200 mb-4">📚 Keputusan Terperinci</h3>
                <div class="overflow-x-auto">
                    <table id="individualTable" class="w-full text-sm">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-300">Bil</th>
                                <th class="px-4 py-2 text-left text-gray-700 dark:text-gray-300">Mata Pelajaran</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Markah</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Gred</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">GP</th>
                                <th class="px-4 py-2 text-center text-gray-700 dark:text-gray-300">Status</th>
                            </tr>
                        </thead>
                        <tbody id="individualBody" class="divide-y divide-gray-200 dark:divide-gray-600">
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="px-4 py-2">1</td>
                                <td class="px-4 py-2 font-medium">BAHASA MELAYU</td>
                                <td class="px-4 py-2 text-center">85</td>
                                <td class="px-4 py-2 text-center">
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800">A</span>
                                </td>
                                <td class="px-4 py-2 text-center">1</td>
                                <td class="px-4 py-2 text-center">
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800">LULUS</span>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="px-4 py-2">2</td>
                                <td class="px-4 py-2 font-medium">MATEMATIK</td>
                                <td class="px-4 py-2 text-center">92</td>
                                <td class="px-4 py-2 text-center">
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800">A+</span>
                                </td>
                                <td class="px-4 py-2 text-center">0</td>
                                <td class="px-4 py-2 text-center">
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800">LULUS</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer-gradient mt-16 border-t border-gray-800">
        <div class="container mx-auto px-6 py-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-2xl mx-auto mb-6">
                <div class="bg-gray-800 bg-opacity-50 rounded-xl p-4 text-center border border-gray-700">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">🎓</span>
                        <div id="footerCertificatePercent" class="text-2xl font-bold text-white">85.2%</div>
                    </div>
                    <div class="text-gray-300 text-sm">Peratus Layak Sijil</div>
                </div>
                
                <div class="bg-gray-800 bg-opacity-50 rounded-xl p-4 text-center border border-gray-700">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">📊</span>
                        <div id="footerGPS" class="text-2xl font-bold text-white">3.45</div>
                    </div>
                    <div class="text-gray-300 text-sm">GPS Sekolah</div>
                </div>
            </div>
            
            <div class="text-center text-gray-400 text-sm border-t border-gray-700 pt-4">
                <div class="mb-2">© 2024 SMK Bukit Jana. Sistem JANAlytics - Analisis Prestasi Akademik</div>
                <div class="text-gray-500">Dibangunkan oleh <span class="font-semibold text-gray-300">Cikgu Hishamanaf</span></div>
            </div>
        </div>
    </footer>

    <script>
        // Sample data for demonstration
        let studentsData = [
            {
                nama: "Ahmad Faiz bin Abdullah",
                kelas: "5A1",
                mykad: "050123-01-1234",
                subjects: {
                    "BAHASA MELAYU": { mark: "85", grade: "A" },
                    "MATEMATIK": { mark: "92", grade: "A+" },
                    "SAINS": { mark: "88", grade: "A" },
                    "SEJARAH": { mark: "78", grade: "A-" }
                }
            },
            {
                nama: "Siti Nurhaliza binti Hassan",
                kelas: "5A1",
                mykad: "050234-02-5678",
                subjects: {
                    "BAHASA MELAYU": { mark: "90", grade: "A+" },
                    "MATEMATIK": { mark: "87", grade: "A" },
                    "SAINS": { mark: "85", grade: "A" },
                    "SEJARAH": { mark: "82", grade: "A" }
                }
            }
        ];

        // Tab navigation function
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-btn').forEach(button => {
                button.classList.remove('active');
            });
            
            const selectedContent = document.getElementById(tabName + '-content');
            if (selectedContent) {
                selectedContent.classList.add('active');
            }
            
            const selectedButton = document.getElementById(tabName);
            if (selectedButton) {
                selectedButton.classList.add('active');
            }
            
            const mobileSelector = document.getElementById('mobileTabSelector');
            if (mobileSelector) {
                mobileSelector.value = tabName;
            }
        }

        // Initialize chart on page load
        window.addEventListener('load', function() {
            initializeGradeChart();
        });

        function initializeGradeChart() {
            const canvas = document.getElementById('gradeChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['BM', 'BI', 'MATEMATIK', 'SAINS', 'SEJARAH', 'PI/PM'],
                    datasets: [{
                        label: 'A+',
                        data: [25, 18, 18, 22, 15, 20],
                        backgroundColor: '#10b981'
                    }, {
                        label: 'A',
                        data: [35, 25, 22, 28, 25, 30],
                        backgroundColor: '#059669'
                    }, {
                        label: 'A-',
                        data: [28, 30, 25, 25, 30, 25],
                        backgroundColor: '#047857'
                    }, {
                        label: 'B+',
                        data: [20, 25, 28, 20, 22, 20],
                        backgroundColor: '#3b82f6'
                    }, {
                        label: 'B',
                        data: [8, 15, 15, 12, 18, 15],
                        backgroundColor: '#2563eb'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            stacked: true,
                            title: {
                                display: true,
                                text: 'Mata Pelajaran'
                            }
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Bilangan Pelajar'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        title: {
                            display: true,
                            text: 'Carta Taburan Gred Mengikut Mata Pelajaran'
                        }
                    }
                }
            });
        }

        // Placeholder functions for button interactions
        function generateOverallAnalysis() {
            alert('Analisis keseluruhan akan dijana berdasarkan penapis yang dipilih.');
        }

        function generateSubjectAnalysis() {
            const subject = document.getElementById('mataPelajaranFilter').value;
            if (!subject) {
                alert('Sila pilih mata pelajaran terlebih dahulu.');
                return;
            }
            
            // Show the stats and student list
            document.getElementById('subjectStats').style.display = 'block';
            document.getElementById('studentListContainer').style.display = 'block';
            
            // Sample data for demonstration
            document.getElementById('totalStudentsSubject').textContent = '120';
            document.getElementById('highestMark').textContent = '95';
            document.getElementById('lowestMark').textContent = '45';
            
            alert(`Analisis untuk ${subject} telah dijana.`);
        }

        function generateCertificateAnalysis() {
            alert('Analisis layak sijil telah dijana berdasarkan BM dan Sejarah.');
        }

        function generateCombatZoneAnalysis() {
            const category = document.getElementById('kategoriFilter').value;
            if (!category) {
                alert('Sila pilih kategori terlebih dahulu.');
                return;
            }
            
            // Show the summary card and student table
            document.getElementById('categorySummaryCard').style.display = 'block';
            document.getElementById('combatStudentTableContainer').style.display = 'block';
            
            alert(`Analisis Combat Zone untuk kategori ${category} telah dijana.`);
        }

        function generateIndividualAnalysis() {
            const student = document.getElementById('namaFilter').value;
            if (!student) {
                alert('Sila pilih pelajar terlebih dahulu.');
                return;
            }
            
            // Show all individual analysis sections
            document.getElementById('studentInfo').style.display = 'block';
            document.getElementById('gradeSummary').style.display = 'block';
            document.getElementById('individualResultsContainer').style.display = 'block';
            
            alert(`Analisis individu untuk ${student} telah dijana.`);
        }

        function updateNameFilter() {
            // This would normally filter names based on selected class
            console.log('Name filter updated based on class selection');
        }

        function updateStudentListDisplay() {
            console.log('Student list display updated');
        }

        function updateCertificateStudentListDisplay() {
            console.log('Certificate student list display updated');
        }

        function updateCombatStudentListDisplay() {
            console.log('Combat student list display updated');
        }

        function changePage(direction) {
            console.log('Page changed:', direction);
        }

        function changePageSijil(direction) {
            console.log('Sijil page changed:', direction);
        }

        function changePageCombat(direction) {
            console.log('Combat page changed:', direction);
        }

        function generateTopStudents() {
            console.log('Top students list updated');
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97b973bd57b11fe1',t:'MTc1NzI4MjE0NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

