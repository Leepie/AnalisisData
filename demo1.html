<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Analisis Combat Zone</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: Arial, sans-serif; }
    #content { display:none; } /* Sembunyikan analisis dulu */
    .box { border:1px solid #ccc; padding:20px; width:300px; margin:100px auto; border-radius:10px; text-align:center; }
    input { padding:8px; width:80%; margin:5px 0; }
    button { padding:8px 20px; cursor:pointer; }
  </style>
</head>
<body class="bg-gray-50">

  <!-- ============ LOGIN BOX ============ -->
  <div id="loginBox" class="box">
    <h2>Masukkan Kod Sekolah</h2>
    <input type="password" id="kodSekolah" placeholder="Contoh: SK1234">
    <br>
    <button onclick="checkKod()">Masuk</button>
    <p id="msg" style="color:red;"></p>
  </div>

  <!-- ============ PAPARAN ANALISIS ============ -->
  <div id="content" class="container mx-auto px-4 py-6">
    <h1 class="text-2xl font-bold mb-4">âš”ï¸ Analisis Combat Zone</h1>

    <!-- Butang Jana Analisis -->
    <div class="mb-4">
      <button onclick="janaAnalisisCombatZone()" 
        class="px-4 py-2 rounded bg-green-600 text-white font-medium hover:bg-green-700">
        ğŸš€ Jana Analisis Combat Zone
      </button>
    </div>

    <!-- Kad Ringkasan -->
    <div id="combatZoneKPIs" class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
      <div class="bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-lg p-4 border border-yellow-200">
        <p class="text-yellow-600 text-xs font-medium">ğŸ† Kualiti 1</p>
        <p id="countKualiti1" class="text-lg font-bold text-yellow-800">0</p>
      </div>
      <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg p-4 border border-gray-200">
        <p class="text-gray-600 text-xs font-medium">ğŸ¥ˆ Kualiti 2</p>
        <p id="countKualiti2" class="text-lg font-bold text-gray-800">0</p>
      </div>
      <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200">
        <p class="text-blue-600 text-xs font-medium">ğŸ›¡ Pertahanan 1</p>
        <p id="countPertahanan1" class="text-lg font-bold text-blue-800">0</p>
      </div>
      <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200">
        <p class="text-orange-600 text-xs font-medium">âš  Pertahanan 2</p>
        <p id="countPertahanan2" class="text-lg font-bold text-orange-800">0</p>
      </div>
      <div class="bg-gradient-to-br from-pink-50 to-pink-100 rounded-lg p-4 border border-pink-200">
        <p class="text-pink-600 text-xs font-medium">ğŸ“Š Kuantiti</p>
        <p id="countKuantiti" class="text-lg font-bold text-pink-800">0</p>
      </div>
    </div>

    <!-- Jadual Pecahan Mengikut Kelas -->
    <h3 class="text-lg font-semibold mb-2">ğŸ“Š Jadual Pecahan Mengikut Kelas</h3>
    <table class="min-w-full border text-sm mb-6">
      <thead>
        <tr>
          <th class="px-4 py-2 text-left bg-red-600 text-white">Kelas</th>
          <th class="px-4 py-2 text-center bg-purple-200">Jumlah</th>
          <th class="px-4 py-2 text-center bg-yellow-100">ğŸ† Kualiti 1</th>
          <th class="px-4 py-2 text-center bg-gray-100">ğŸ¥ˆ Kualiti 2</th>
          <th class="px-4 py-2 text-center bg-blue-100">ğŸ›¡ Pertahanan 1</th>
          <th class="px-4 py-2 text-center bg-orange-100">âš  Pertahanan 2</th>
          <th class="px-4 py-2 text-center bg-pink-100">ğŸ“Š Kuantiti</th>
        </tr>
      </thead>
      <tbody id="combatZoneClassTableBody"></tbody>
    </table>

    <!-- Senarai Murid Mengikut Kategori -->
    <h3 class="text-lg font-semibold mb-2">ğŸ‘¥ Senarai Murid Mengikut Kategori</h3>
    <div class="flex flex-wrap gap-2 mb-3">
      <button id="btnKualiti1" onclick="switchCombatZoneCategory('kualiti1')" class="px-3 py-1 rounded bg-gray-200">ğŸ† Kualiti 1 (0)</button>
      <button id="btnKualiti2" onclick="switchCombatZoneCategory('kualiti2')" class="px-3 py-1 rounded bg-gray-200">ğŸ¥ˆ Kualiti 2 (0)</button>
      <button id="btnPertahanan1" onclick="switchCombatZoneCategory('pertahanan1')" class="px-3 py-1 rounded bg-gray-200">ğŸ›¡ Pertahanan 1 (0)</button>
      <button id="btnPertahanan2" onclick="switchCombatZoneCategory('pertahanan2')" class="px-3 py-1 rounded bg-gray-200">âš  Pertahanan 2 (0)</button>
      <button id="btnKuantiti"   onclick="switchCombatZoneCategory('kuantiti')"   class="px-3 py-1 rounded bg-gray-200">ğŸ“Š Kuantiti (0)</button>
    </div>

    <!-- Tajuk dinamik -->
    <h4 id="combatZoneCategoryTitle" class="text-md font-semibold mb-2 text-gray-700">Senarai Murid</h4>

    <table class="min-w-full border border-gray-200 text-sm">
      <thead>
        <tr id="combatZoneCategoryHeader">
          <th class="px-4 py-2 text-left">Bil</th>
          <th class="px-4 py-2 text-left">Nama</th>
          <th class="px-4 py-2 text-center">Kelas</th>
          <th class="px-4 py-2 text-center">GP</th>
        </tr>
      </thead>
      <tbody id="combatZoneCategoryStudentTable"></tbody>
    </table>
  </div>

  <script>
  // ==================== LOGIN ====================
  function checkKod(){
    const kod = document.getElementById("kodSekolah").value.trim().toUpperCase();
    const kodBetul = "SK1234"; // ğŸ”‘ Tukar ikut kod sekolah sebenar

    if(kod === kodBetul){
      document.getElementById("loginBox").style.display = "none";
      document.getElementById("content").style.display = "block";
    } else {
      document.getElementById("msg").innerText = "Kod salah! Sila cuba lagi.";
    }
  }

  // ==================== DATA DEMO ====================
  let cachedData = [
    { nama:"Ali", kelas:"5A", BM:"A", BI:"B+", MATH:"A-" },
    { nama:"Siti", kelas:"5A", BM:"C", BI:"B", MATH:"B+" },
    { nama:"Abu", kelas:"5B", BM:"E", BI:"D", MATH:"G" },
    { nama:"Fatimah", kelas:"5C", BM:"A+", BI:"A", MATH:"A" },
  ];
  let subjectColumns = ["BM","BI","MATH"];
  const gradeValueMapping = { "A+":0,"A":1,"A-":2,"B+":3,"B":4,"C+":5,"C":6,"D":7,"E":8,"G":9,"X":9,"TH":9,"":9 };

  let muridDataCZ = [];
  let totals = {};

  // ========== Fungsi Combat Zone (sama macam versi asal) ==========
  function janaAnalisisCombatZone(){ generateCombatZone(); renderCombatZoneClassBreakdown(cachedData); switchCombatZoneCategory("kualiti1"); }
  function generateCombatZone(){ /* ... semua kod asal ... */ }
  function renderCombatZoneClassBreakdown(data){ /* ... semua kod asal ... */ }
  function switchCombatZoneCategory(kategori){ /* ... semua kod asal ... */ }
  </script>
</body>
</html>
